{"version":3,"sources":["<anon>"],"sourcesContent":["function debounce(func, wait, immediate) {\r\n    var timeout;\r\n    return function () {\r\n        var context = this, args = arguments;\r\n        var later = function () {\r\n            timeout = null;\r\n            if (!immediate) func.apply(context, args);\r\n        };\r\n        var callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) func.apply(context, args);\r\n    };\r\n};\r\nfunction initVueMultiselect(element) {\r\n    // only run script if element exists\r\n    if (element) {\r\n        var elementId = element.id;\r\n        var selectedItems = JSON.parse(element.dataset.selectedItems || \"[]\");\r\n        var editUrl = element.dataset.editUrl;\r\n        var viewUrl = element.dataset.viewUrl;\r\n        var searchUrl = element.dataset.searchUrl;\r\n        var multiple = JSON.parse(element.dataset.multiple);\r\n\r\n        var debouncedSearch = debounce(function (vm, query) {\r\n            vm.isLoading = true;\r\n            var searchFullUrl = searchUrl;\r\n            if (query) {\r\n                searchFullUrl += '&query=' + query;\r\n            }\r\n            fetch(searchFullUrl).then(function (res) {\r\n                res.json().then(function (json) {\r\n                    vm.options = json;\r\n                    vm.isLoading = false;\r\n                })\r\n            });\r\n        }, 250);\r\n\r\n        var vueMultiselect = Vue.component('vue-multiselect', window.VueMultiselect.default);\r\n\r\n        var vm = new Vue({\r\n            el: '#' + elementId,\r\n            components: { 'vue-multiselect': vueMultiselect },\r\n            data: {\r\n                value: null,\r\n                arrayOfItems: selectedItems,\r\n                options: [],\r\n            },\r\n            computed: {\r\n                selectedIds: function () {\r\n                    return this.arrayOfItems.map(function (x) { return x.id }).join(',');\r\n                },\r\n                isDisabled: function () {\r\n                    return this.arrayOfItems.length > 0 && !multiple;\r\n                }\r\n            },\r\n            watch: {\r\n                selectedIds: function () {\r\n                    // We add a delay to allow for the <input> to get the actual value\t\r\n                    // before the form is submitted\t\r\n                    setTimeout(function () { $(document).trigger('contentpreview:render') }, 100);\r\n                }\r\n            },\r\n            created: function () {\r\n                var self = this;\r\n                self.asyncFind();\r\n            },\r\n            mounted: function () {\r\n                // Store a reference to the div containing the search box used to select content\r\n                // items so we can hide/show it later (in onSelect and remove). We use the \"mounted\"\r\n                // lifecycle method rather than \"created\" so we know the component has been attached \r\n                // to the DOM and we can therefore travese the DOM to find the desired div.\r\n                this.searchBoxContainer = $(this.$el).children().last();\r\n\r\n                // If we're loading an existing content item, we may already have a content picker\r\n                // configured to only allow a single content item and that item has already been selected. \r\n                // In this case, we need to hide the search box now and not wait for onSelect or remove.\r\n                this.searchBoxContainer.css(\"display\", multiple || this.arrayOfItems.length === 0 ? \"block\" : \"none\");\r\n            },\r\n            methods: {\r\n                asyncFind: function (query) {\r\n                    var self = this;\r\n                    debouncedSearch(self, query);\r\n                },\r\n                onSelect: function (selectedOption, id) {\r\n                    var self = this;\r\n\r\n                    for (i = 0; i < self.arrayOfItems.length; i++) {\r\n                        if (self.arrayOfItems[i].id === selectedOption.id) {\r\n                            return;\r\n                        }\r\n                    }\r\n\r\n                    self.arrayOfItems.push(selectedOption);\r\n\r\n                    // We don't want to show the search box if we are only allowing a single content \r\n                    // item and a content item has already been selected. We don't need that search \r\n                    // box again unless and until we delete the currently selected content item. \r\n                    // So here we set the display mode accordingly. We always show the select list \r\n                    // if allowing multiple content items and do not show it if we're only allowing \r\n                    // a single content item and we've just selected that one item.\r\n                    this.searchBoxContainer.css(\"display\", multiple ? \"block\" : \"none\");\r\n                },\r\n                url: function(item) {\r\n                    var url = item.isEditable ? editUrl : viewUrl;\r\n                    return url.replace('contentItemId', item.id);\r\n                },\r\n                remove: function (item) {\r\n                    this.arrayOfItems.splice(this.arrayOfItems.indexOf(item), 1);\r\n\r\n                    // After removing a selected content item, we always want to show the search box \r\n                    // since (1) if we are allowing multiple content types to be selected, we always \r\n                    // want to show it, and (2) if we are only allowing a single content type to be \r\n                    // selected, and we've just removed that content type, we now need to show the \r\n                    // search box so we are able to add a new one.\r\n                    this.searchBoxContainer.css(\"display\", \"block\");\r\n                }\r\n            }\r\n        })\r\n        \r\n        /*Hook for other scripts that might want to have access to the view model*/\r\n        var event = new CustomEvent(\"vue-multiselect-created\", { detail: { vm: vm } });\r\n        document.querySelector(\"body\").dispatchEvent(event);\r\n    }\r\n}\r\n"],"names":["debounce","func","wait","immediate","timeout","context","args","arguments","callNow","clearTimeout","setTimeout","apply","initVueMultiselect","element","elementId","id","selectedItems","JSON","parse","dataset","editUrl","viewUrl","searchUrl","multiple","debouncedSearch","vm","query","isLoading","searchFullUrl","fetch","then","res","json","options","vueMultiselect","Vue","component","window","VueMultiselect","default","event","CustomEvent","detail","el","components","data","value","arrayOfItems","computed","selectedIds","map","x","join","isDisabled","length","watch","$","document","trigger","created","self","asyncFind","mounted","searchBoxContainer","$el","children","last","css","methods","onSelect","selectedOption","i","push","url","item","isEditable","replace","remove","splice","indexOf","querySelector","dispatchEvent"],"mappings":"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"}