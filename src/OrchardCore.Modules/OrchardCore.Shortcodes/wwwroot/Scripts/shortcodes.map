{"version":3,"sources":["<anon>"],"sourcesContent":["/// jQuery helper to append text to a textarea or input.\r\njQuery.fn.extend({\r\n    insertAtCaret: function (myValue) {\r\n        return this.each(function (i) {\r\n            if (document.selection) {\r\n                //For browsers like Internet Explorer\r\n                this.focus();\r\n                sel = document.selection.createRange();\r\n                sel.text = myValue;\r\n                this.focus();\r\n            } else if (this.selectionStart || this.selectionStart === \"0\") {\r\n                //For browsers like Firefox and Webkit based\r\n                var startPos = this.selectionStart;\r\n                var endPos = this.selectionEnd;\r\n                var scrollTop = this.scrollTop;\r\n                this.value = this.value.substring(0, startPos) + myValue + this.value.substring(endPos, this.value.length);\r\n                this.focus();\r\n                this.selectionStart = startPos + myValue.length;\r\n                this.selectionEnd = startPos + myValue.length;\r\n                this.scrollTop = scrollTop;\r\n            } else {\r\n                this.value += myValue;\r\n                this.focus();\r\n            }\r\n        });\r\n    }\r\n});\r\n\r\nconst shortcodeWrapperTemplate = `\r\n<div class=\"shortcode-modal-wrapper\"></div>\r\n`;\r\n\r\nconst shortcodeBtnTemplate = `\r\n<button type=\"button\" class=\"shortcode-modal-btn btn btn-sm\">\r\n    <span class=\"icon-shortcode\"></span>\r\n</button>\r\n`;\r\n\r\n// Wraps each .shortcode-modal-input class with a wrapper, and attaches detaches the shortcode app as required.\r\n$(function () {\r\n    $('.shortcode-modal-input').each(function () {\r\n        $(this).wrap(shortcodeWrapperTemplate);\r\n        $(this).parent().append(shortcodeBtnTemplate);\r\n    });\r\n\r\n    $('.shortcode-modal-btn').on('click', function() {\r\n        var input = $(this).siblings('.shortcode-modal-input');\r\n\r\n        shortcodesApp.init(function (defaultValue) {\r\n            input.insertAtCaret(defaultValue);\r\n        });    \r\n    });\r\n})\r\n\r\nvar shortcodesApp;\r\n\r\nfunction initializeShortcodesApp(element) {\r\n    if (element && !shortcodesApp) {\r\n        var elementId = element.id;\r\n\r\n        shortcodesApp = new Vue({\r\n            el: '#' + elementId,\r\n            data : function () {\r\n                \r\n                var shortcodes = JSON.parse(element.dataset.shortcodes || \"[]\");\r\n                var categories = JSON.parse(element.dataset.categories || \"[]\");\r\n\r\n                return {\r\n                    filter: '',\r\n                    allShortcodes: shortcodes,\r\n                    filteredShortcodes: shortcodes,\r\n                    categories: categories,\r\n                    defaultValue: '',\r\n                    modal: null\r\n                }\r\n            },\r\n            watch:\r\n            {\r\n                filter(filter) {\r\n                    if (filter) {\r\n                        var lower = filter.toLowerCase();\r\n                        this.filteredShortcodes = this.allShortcodes\r\n                            .filter(s => s.name.startsWith(lower));\r\n                    } else {\r\n                        this.filteredShortcodes = this.allShortcodes;\r\n                    }\r\n                }\r\n            },            \r\n            methods: {\r\n                init(onClose)\r\n                {\r\n                    if (onClose) {\r\n                        this.onClose = onClose;\r\n                    }\r\n                    this.selectedValue = '';\r\n                    this.modal = new bootstrap.Modal(this.$el);\r\n                    this.modal.show();\r\n                    var self = this;\r\n                    $(this.$el).on('shown.bs.modal', function (e) {\r\n                        self.$refs.filter.focus();\r\n                    });\r\n                },\r\n                onClose(defaultValue)\r\n                {\r\n                    return;\r\n                },\r\n                setCategory(category)\r\n                {\r\n                    if (category) {\r\n                        this.filteredShortcodes = this.allShortcodes\r\n                            .filter(s => s.categories.some(c => c.toLowerCase() === category.toLowerCase()));\r\n                    } else {\r\n                        this.filteredShortcodes = this.allShortcodes;\r\n                    }\r\n                    this.filter = '';\r\n                },            \r\n                isVisible(name) {\r\n                    return this.filteredShortcodes.some(s => s.name === name);\r\n                },\r\n                insertShortcode(event) {\r\n                    this.defaultValue =  event.target.dataset.defaultValue;\r\n                    this.modal.hide();\r\n                    this.onClose(this.defaultValue);\r\n                }\r\n            }\r\n        });\r\n\r\n        return shortcodesApp;\r\n    }\r\n}\r\n\r\n// initializes a code mirror editor with a shortcode modal.\r\nfunction initializeCodeMirrorShortcodeWrapper(editor) {\r\n    const codemirrorWrapper = editor.display.wrapper;\r\n\r\n    $(codemirrorWrapper).wrap(shortcodeWrapperTemplate);\r\n    $(codemirrorWrapper).parent().append(shortcodeBtnTemplate);\r\n    $(codemirrorWrapper).siblings('.shortcode-modal-btn').on('click', function () {\r\n        shortcodesApp.init(function (defaultValue) {\r\n            editor.replaceSelection(defaultValue);   \r\n        });   \r\n    });  \r\n}\r\n"],"names":["shortcodesApp","jQuery","fn","extend","insertAtCaret","myValue","each","i","document","selection","focus","sel","createRange","text","selectionStart","startPos","endPos","selectionEnd","scrollTop","value","substring","length","shortcodeWrapperTemplate","shortcodeBtnTemplate","initializeShortcodesApp","element","Vue","el","id","data","shortcodes","JSON","parse","dataset","filter","allShortcodes","filteredShortcodes","categories","defaultValue","modal","watch","lower","toLowerCase","s","name","startsWith","methods","init","onClose","selectedValue","bootstrap","Modal","$el","show","self","$","on","e","$refs","setCategory","category","some","c","isVisible","insertShortcode","event","target","hide","initializeCodeMirrorShortcodeWrapper","editor","codemirrorWrapper","display","wrapper","wrap","parent","append","siblings","replaceSelection","input"],"mappings":"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"}