{"version":3,"sources":["<anon>"],"sourcesContent":["notificationManager = function () {\r\n\r\n    const removeItem = (values, value) => {\r\n        const index = values.indexOf(value);\r\n\r\n        if (index > -1) {\r\n            values.splice(index, 1);\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    const initialize = (readUrl, unreadBadgeSelector, wrapperSelector) => {\r\n\r\n        if (!readUrl) {\r\n            console.log('No readUrl was provided.');\r\n\r\n            return;\r\n        }\r\n\r\n        const reading = [];\r\n        let totalUnread = 0;\r\n        let unreadElement = null;\r\n\r\n        if (unreadBadgeSelector) {\r\n            unreadElement = document.querySelector(unreadBadgeSelector);\r\n\r\n            if (unreadElement) {\r\n                totalUnread = parseInt(unreadElement.innerText)\r\n            }\r\n        }\r\n\r\n        var elements = document.getElementsByClassName('mark-notification-as-read');\r\n\r\n        for (let i = 0; i < elements.length; i++) {\r\n\r\n            ['click', 'mouseover'].forEach((evt) => {\r\n                elements[i].addEventListener(evt, (e) => {\r\n\r\n                    if (e.target.getAttribute('data-is-read') != \"false\") {\r\n                        return;\r\n                    }\r\n\r\n                    var messageId = e.target.getAttribute('data-message-id');\r\n\r\n                    if (!messageId) {\r\n                        return;\r\n                    }\r\n\r\n                    if (reading.includes(messageId)) {\r\n                        // If a message is pending request, no need to send another request.\r\n                        return;\r\n                    }\r\n\r\n                    reading.push(messageId);\r\n\r\n                    fetch(readUrl, {\r\n                        method: 'POST',\r\n                        headers: {\r\n                            'Content-Type': 'application/json'\r\n                        },\r\n                        body: JSON.stringify({ messageId: messageId })\r\n                    }).then(response => response.json())\r\n                        .then(result => {\r\n                            if (result.updated) {\r\n\r\n                                if (unreadElement) {\r\n                                    if (totalUnread > 1) {\r\n                                        unreadElement.innerText = --totalUnread;\r\n                                    } else {\r\n                                        unreadElement.style.display = 'none';\r\n                                    }\r\n                                }\r\n\r\n                                if (wrapperSelector) {\r\n                                    var wrapper = e.target.closest(wrapperSelector);\r\n                                    if (wrapper) {\r\n                                        wrapper.classList.remove('notification-is-unread');\r\n                                        wrapper.classList.add('notification-is-read');\r\n                                        wrapper.setAttribute('data-is-read', true);\r\n                                        removeItem(reading, messageId);\r\n                                    }\r\n                                } else {\r\n                                    e.target.classList.remove('notification-is-unread');\r\n                                    e.target.classList.add('notification-is-read');\r\n                                    e.target.setAttribute('data-is-read', true);\r\n                                    removeItem(reading, messageId);\r\n                                }\r\n                            }\r\n\r\n                            var targetUrl = e.target.getAttribute('data-target-url');\r\n\r\n                            if (targetUrl) {\r\n                                window.location.href = targetUrl;\r\n                            }\r\n                        });\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    return {\r\n        initializeContainer: initialize\r\n    };\r\n}();\r\n"],"names":["notificationManager","removeItem","values","value","index","indexOf","splice","initializeContainer","readUrl","unreadBadgeSelector","wrapperSelector","console","log","reading","totalUnread","unreadElement","document","querySelector","parseInt","innerText","elements","getElementsByClassName","i","length","forEach","evt","addEventListener","e","target","getAttribute","messageId","includes","push","fetch","method","headers","body","JSON","stringify","then","response","json","result","updated","style","display","wrapper","closest","classList","remove","add","setAttribute","targetUrl","window","location","href"],"mappings":"AAAAA,oBAAsB,WAElB,IAAMC,EAAa,CAACC,EAAQC,KACxB,IAAMC,EAAQF,EAAOG,OAAO,CAACF,UAE7B,AAAIC,EAAQ,KACRF,EAAOI,MAAM,CAACF,EAAO,GAEd,CAAA,EAIf,EA2FA,MAAO,CACHG,oBA1Fe,CAACC,EAASC,EAAqBC,KAE9C,GAAI,CAACF,EAAS,CACVG,QAAQC,GAAG,CAAC,4BAEZ,MACJ,CAEA,IAAMC,EAAU,EAAE,CACdC,EAAc,EACdC,EAAgB,KAEhBN,GACAM,CAAAA,EAAgBC,SAASC,aAAa,CAACR,EAAmB,GAGtDK,CAAAA,EAAcI,SAASH,EAAcI,SAAS,CAAA,EAItD,IAAIC,EAAWJ,SAASK,sBAAsB,CAAC,6BAE/C,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAASG,MAAM,CAAED,IAEjC,CAAC,QAAS,YAAY,CAACE,OAAO,CAAC,AAACC,IAC5BL,CAAQ,CAACE,EAAE,CAACI,gBAAgB,CAACD,EAAK,AAACE,IAE/B,GAAIA,AAAyC,SAAzCA,EAAEC,MAAM,CAACC,YAAY,CAAC,iBAI1B,IAAIC,EAAYH,EAAEC,MAAM,CAACC,YAAY,CAAC,kBAElC,EAACC,GAIDjB,EAAQkB,QAAQ,CAACD,KAKrBjB,EAAQmB,IAAI,CAACF,GAEbG,MAAMzB,EAAS,CACX0B,OAAQ,OACRC,QAAS,CACL,eAAgB,kBACpB,EACAC,KAAMC,KAAKC,SAAS,CAAC,CAAER,UAAWA,CAAU,EAChD,GAAGS,IAAI,CAACC,GAAYA,EAASC,IAAI,IAC5BF,IAAI,CAACG,IACF,GAAIA,EAAOC,OAAO,EAUd,GARI5B,IACID,EAAc,EACdC,EAAcI,SAAS,CAAG,EAAEL,EAE5BC,EAAc6B,KAAK,CAACC,OAAO,CAAG,QAIlCnC,EAAiB,CACjB,IAAIoC,EAAUnB,EAAEC,MAAM,CAACmB,OAAO,CAACrC,GAC3BoC,IACAA,EAAQE,SAAS,CAACC,MAAM,CAAC,0BACzBH,EAAQE,SAAS,CAACE,GAAG,CAAC,wBACtBJ,EAAQK,YAAY,CAAC,eAAgB,CAAA,GACrClD,EAAWY,EAASiB,GAE5B,MACIH,EAAEC,MAAM,CAACoB,SAAS,CAACC,MAAM,CAAC,0BAC1BtB,EAAEC,MAAM,CAACoB,SAAS,CAACE,GAAG,CAAC,wBACvBvB,EAAEC,MAAM,CAACuB,YAAY,CAAC,eAAgB,CAAA,GACtClD,EAAWY,EAASiB,GAI5B,IAAIsB,EAAYzB,EAAEC,MAAM,CAACC,YAAY,CAAC,mBAElCuB,GACAC,CAAAA,OAAOC,QAAQ,CAACC,IAAI,CAAGH,CAAQ,CAEvC,IACR,EACJ,EAER,CAIA,CACJ"}